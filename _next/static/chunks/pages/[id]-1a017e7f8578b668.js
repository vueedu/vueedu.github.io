(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[112],{6877:function(e,s,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/[id]",function(){return n(904)}])},6170:function(e,s,n){"use strict";var l=n(5893),a=n(5606);let t=e=>(0,l.jsx)("div",{className:"loading-container",children:(0,l.jsx)(a.Z,{tip:"数据加载中...",size:"small",...e})});s.Z=t},904:function(e,s,n){"use strict";n.r(s),n.d(s,{Course:function(){return B},__N_SSG:function(){return P},default:function(){return F}});var l=n(5893),a=n(7294),t=n(6486),i=n(1958),c=n(9250),r=n(1653),d=n(9499);let o=e=>{let{items:s}=e,[n,t]=(0,a.useState)(s[0].key),i=e=>{t(e)};return(0,l.jsxs)("div",{className:"tabs",children:[(0,l.jsx)("div",{className:"tab-nav-list",children:s.map(e=>{let{title:s,key:a}=e;return(0,l.jsx)("div",{className:"tabs-tab ".concat(a===n?"tabs-tab-active":""),onClick:()=>i(a),children:s},a)})}),(0,l.jsx)("div",{className:"tabs-content-list",children:s.map(e=>{let{key:s,content:a}=e;return(0,l.jsx)("div",{className:"tabs-content-item ".concat(s===n?"":"tabs-content-item-hidden"),children:a},s)})})]})};var m=n(6170),u=n(3817),h=n(9136),x=n(6737),j=n(2584),p=n(9465),v=n(1004),f=n(9655),N=n(9843),g=n(1534),b=n(3019);let I=["大一","大二","大三","大四","硕士研究生","博士研究生","大学老师","公司技术工程师","其他"],y=[{value:"未订阅通知",label:"不订阅通知"},{value:"已订阅短信通知",label:"订阅短信通知"},{value:"已订阅电话通知",label:"订阅电话通知"},{value:"已订阅全部通知",label:"订阅全部通知"}],_=e=>{let[s]=h.Z.useForm(),n=async s=>{let n={...s};2!=n.status||n.name.endsWith("老师")||(n.name=n.name+"老师"),n.status=n.status||1,n.phone=localStorage.getItem(N.VY),n.clientId=e.courseInfo.clientId,n.courseId=e.courseInfo.courseId,n.uniCourseId=e.courseInfo.id,n.course=e.courseInfo.title,n.verify="1",n.classId=1;let l=await (0,g.L0)(n);e.onSubmit(l)};return(0,l.jsxs)(h.Z,{form:s,className:"normal-form",onFinish:n,autoComplete:"off",size:"large",labelCol:{span:4},wrapperCol:{span:20},initialValues:{gender:"男",tag:y[1].value},children:[(0,l.jsx)("h3",{children:"报名"}),(0,l.jsx)(h.Z.Item,{label:"姓名",name:"name",rules:[{required:!0,message:"请输入姓名"}],children:(0,l.jsx)(x.Z,{placeholder:"请输入姓名"})}),(0,l.jsx)(h.Z.Item,{label:"性别",name:"gender",children:(0,l.jsxs)(j.ZP.Group,{children:[(0,l.jsx)(j.ZP,{value:"男",children:"男"}),(0,l.jsx)(j.ZP,{value:"女",children:"女"})]})}),(0,l.jsx)(h.Z.Item,{label:"年级",name:"age",children:(0,l.jsx)(p.Z,{children:I.map(e=>(0,l.jsx)(p.Z.Option,{value:e,children:e},e))})}),(0,l.jsx)(h.Z.Item,{label:"备注",name:"tag",children:(0,l.jsx)(p.Z,{children:y.map(e=>{let{label:s,value:n}=e;return(0,l.jsx)(p.Z.Option,{value:n,children:s},n)})})}),(0,l.jsx)(h.Z.Item,{wrapperCol:{span:24},children:(0,l.jsx)(v.Z,{style:{width:"100%"},type:"primary",htmlType:"submit",children:"确认"})})]})},C=e=>{let[s,n]=(0,a.useState)(e.defaultVisible),{state:{myRegisters:t},dispatch:i}=(0,b.mr)(),c=s=>{var l;i({type:"UPDATE_MY_COURSES",payload:(t||[]).concat(s)}),null===(l=e.onRegisterCourse)||void 0===l||l.call(e,s),n(!1)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{className:"btn",onClick:()=>n(!0),children:"立即报名"}),(0,l.jsx)(f.Z,{width:350,open:s,footer:null,onCancel:()=>n(!1),maskClosable:!1,children:(0,l.jsx)(_,{onSubmit:c,courseInfo:e.courseInfo})})]})};var Z=n(400),k=n(4440);let w={2:"status-teacher.png",4:"status-ta.png",5:"status-admin.png"},S=e=>{let s=(0,b.dD)();return(0,t.isEmpty)(e.data)?(0,l.jsx)("div",{className:"studentlist-wrap",children:(0,l.jsx)(k.Z,{})}):(null==s?void 0:s.mobile())?(0,l.jsx)("div",{className:"list-mobile",children:(0,t.map)(e.data,(e,s)=>(0,l.jsxs)("div",{className:"list-item",children:[(0,l.jsx)("div",{className:"list-item-index",children:s+1}),(0,l.jsxs)("div",{className:"list-item-main-info",children:[(0,l.jsxs)("div",{className:"info-name",children:[e.name,e.status!==d.d.STUDENT&&(0,l.jsx)("img",{height:"14",src:"img/".concat(w[e.status]),alt:"student-status-png"})]}),(0,l.jsx)("div",{className:"info-other",children:(0,l.jsxs)("span",{className:"current-bg",children:[(0,l.jsx)("span",{className:"list-item-label",children:"职业:"})," ",e.age]})})]}),(0,l.jsx)("div",{className:"list-item-gender ".concat("女"===e.gender?"woman":"man"),children:"女"===e.gender?(0,l.jsx)(u.Z,{symbol:"icon-nv"}):(0,l.jsx)(u.Z,{symbol:"icon-xingbienan"})}),(0,l.jsx)("div",{className:"list-item-tag",children:e.tag})]},e.id))}):(0,l.jsx)("div",{className:"list-wrap",children:(0,l.jsxs)("table",{cellSpacing:"0",cellPadding:"0",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:(0,l.jsx)("span",{children:"昵称"})}),(0,l.jsx)("th",{children:(0,l.jsx)("span",{children:"年级"})}),(0,l.jsx)("th",{children:(0,l.jsx)("span",{children:"性别"})}),(0,l.jsx)("th",{children:(0,l.jsx)("span",{children:"备注"})})]})}),(0,l.jsx)("tbody",{children:(0,t.map)(e.data,(e,s)=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{className:"lalign",children:[(0,l.jsx)("span",{className:"index",children:s+1}),(0,l.jsxs)("span",{className:"student-name",children:[e.name,e.status!==d.d.STUDENT&&(0,l.jsx)("img",{height:"14",src:"img/".concat(w[e.status]),alt:"student-status-png"})]})]}),(0,l.jsx)("td",{children:e.age}),(0,l.jsx)("td",{children:e.gender}),(0,l.jsx)("td",{children:e.tag})]},e.id))})]})})};var E=n(1527),T=n(1163);let R=["教室号","课程名称","开始时间","上课地点","备注","课堂回放"],O=e=>{let s=(0,b.dD)(),n=(0,T.useRouter)(),{state:{currentUser:a,myRegisters:i},dispatch:r}=(0,b.mr)(),{id:d}=(0,c.UO)(),o=async e=>n.push("replay/".concat(e.id)),m=e=>{if(null==a?void 0:a.phone){let s=(0,t.find)(i,e=>e.courseId===d);if(s){let{verify:n}=s;"1"===n?o(e):E.u_.alert({content:"报名信息审核通过即可观看",closeOnMaskClick:!0})}else E.u_.alert({content:"请报名课程后观看",closeOnMaskClick:!0})}else r({type:"UPDATE_LOGIN_DIALOG_VISIBLE",payload:!0})};return(null==s?void 0:s.mobile())?(0,l.jsx)("div",{className:"list-mobile",children:(0,t.map)(e.data,e=>(0,l.jsxs)("div",{className:"list-item",onClick:()=>m(e),children:[(0,l.jsxs)("div",{className:"list-item-main-info",children:[(0,l.jsxs)("div",{className:"info-name",children:[e.className,(0,l.jsx)("span",{className:"location-tag",children:e.location})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"list-item-label",children:"教室号:"})," ",e.roomId]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"list-item-label",children:"开始时间:"})," ",e.startAt]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"list-item-label",children:"备注:"})," ",e.remark]})]}),(0,l.jsx)("div",{className:"list-item-actions",children:(0,l.jsx)(u.Z,{symbol:"icon-bofang"})})]},e.id))}):(0,l.jsx)("div",{className:"list-wrap",children:(0,l.jsxs)("table",{cellSpacing:"0",cellPadding:"0",children:[(0,l.jsx)("thead",{children:(0,l.jsx)("tr",{children:R.map(e=>(0,l.jsx)("th",{children:(0,l.jsx)("span",{children:e})},e))})}),(0,l.jsx)("tbody",{children:(0,t.map)(e.data,(e,s)=>(0,l.jsxs)("tr",{children:[(0,l.jsxs)("td",{className:"lalign",children:[(0,l.jsx)("span",{className:"index",children:s+1}),e.roomId]}),(0,l.jsx)("td",{children:e.className}),(0,l.jsx)("td",{children:e.startAt}),(0,l.jsx)("td",{children:e.location}),(0,l.jsx)("td",{children:e.remark}),(0,l.jsx)("td",{children:(0,l.jsx)("span",{className:"player-btn",onClick:()=>m(e),children:(0,l.jsx)(u.Z,{symbol:"icon-bofang"})})})]},e.id))})]})})},U=e=>{let{state:{currentUser:s,myRegisters:n},dispatch:i}=(0,b.mr)(),{id:d}=(0,c.UO)(),o=(0,a.useRef)(null),m=(0,a.useRef)(null),h="";if(null==s?void 0:s.phone){let s=(0,t.find)(n,e=>e.courseId===d);if(s){let n=encodeURIComponent("pages/room/room?userId=".concat(s.phone,"-m&roomId=").concat(e.courseInfo.roomId,"&role=").concat(N.sJ[s.status]||"student","&username=").concat(s.name,"-m"));h="".concat(Z._,"/seller/api/room/path.jpg?path=").concat(n)}else{let s=encodeURIComponent("pages/index/index?roomId=".concat(e.courseInfo.roomId));h="".concat(Z._,"/seller/api/room/path.jpg?path=").concat(s)}}return(0,a.useEffect)(()=>{if(m.current){let e=m.current,s=new XMLSerializer().serializeToString(e);o.current.src="data:image/svg+xml;base64,".concat(btoa(s))}},[m.current]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(r.Z,{ref:m,style:{display:"none",height:"auto",maxWidth:"100%",width:"100%"},value:window.location.href,fgColor:"#3db477",viewBox:"0 0 256 256"}),(0,l.jsxs)("div",{className:"share-box",children:[(0,l.jsxs)("span",{children:[(0,l.jsx)(u.Z,{symbol:"icon-share"}),"分享二维码"]}),(0,l.jsx)("span",{style:{marginBottom:10},children:"邀请好友加入课堂"}),(0,l.jsxs)("div",{className:"share-imgs ".concat(e.isMobile?"share-imgs-mobile":""),children:[(0,l.jsx)("img",{ref:o,alt:"share-course",className:"qr-code"}),h&&(0,l.jsx)("img",{src:h,alt:"mini"})]})]})]})},L=e=>{let{state:{currentUser:s,myRegisters:n},dispatch:a}=(0,b.mr)(),{id:i}=(0,c.UO)(),r=()=>{a({type:"UPDATE_LOGIN_DIALOG_VISIBLE",payload:!0})},d=e=>{let{name:s,phone:n,status:l}=e};if(null==s?void 0:s.phone){let s=(0,t.find)(n,e=>e.courseId===i);return s?(0,l.jsx)("button",{className:"btn",onClick:()=>{let{verify:e}=s;"1"===e?d(s):E.u_.alert({content:"报名信息审核通过即可进入教室",closeOnMaskClick:!0})},children:"已报名，进入教室"}):(0,l.jsx)(C,{...e})}return(0,l.jsx)("button",{className:"btn",onClick:r,children:"登录"})},A=e=>{var s,n,c,r,h;let{data:x}=e,[j,p]=(0,a.useState)({...x}),[v,f]=(0,a.useState)([]),N=(0,b.dD)(),I=(0,a.useRef)({}),[y,_]=(0,a.useState)(!0),C=(0,a.useCallback)(async()=>{console.log("开始加载");let e=await (0,g.mU)(x.courseId),s=(0,t.groupBy)(e,"status"),n=s[d.d.TEACHER]||[],l=s[d.d.TUTOR]||[],a=s[d.d.ADMIN]||[],i=[];(0,t.keys)(s).filter(e=>![d.d.TEACHER,d.d.TUTOR,d.d.ADMIN].includes(e)).forEach(e=>{i=i.concat(s[e])}),I.current.applyStudents=i,I.current.teacher=(0,t.last)(n);let c=n.concat(l,a,i);f(c),I.current.if_teacher=!I.current.teacher;let r=await (0,g.Rj)(x.courseId);I.current.replayList=r,I.current.validReplayList=(0,t.sortBy)(r.filter(e=>{let{status:s}=e;return 1==s})||[],e=>e.startAt),p(j),_(!1)},[]);if((0,a.useEffect)(()=>{C()},[C]),y)return(0,l.jsx)(m.Z,{});let Z=[{key:"intro",title:"课程介绍",content:(0,l.jsx)("div",{className:"ql-snow ql-editor",dangerouslySetInnerHTML:{__html:j.introduction}})},{key:"student",title:"报名成员(".concat((null==v?void 0:v.length)||0,")"),content:(0,l.jsx)(S,{data:v})},{key:"replay",title:"课堂回放(".concat(null===(s=I.current.validReplayList)||void 0===s?void 0:s.length,")"),content:(0,l.jsx)(O,{data:I.current.validReplayList})}],k=e=>{f((v||[]).concat(e)),I.current.applyStudents=(I.current.applyStudents||[]).concat(e)};return(0,l.jsxs)("div",{className:"course-detail-wrapper",children:[(0,l.jsxs)("section",{className:"main-content",children:[(0,l.jsx)("img",{src:j.coverUrl,alt:"coverUrl",className:"course-cover"}),(0,l.jsx)("div",{className:"course-main-info",children:(null==N?void 0:N.mobile())?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"course-title",children:j.title}),(0,l.jsxs)("div",{className:"course-info",children:[(0,l.jsxs)("div",{className:"course-info-item",children:[(0,l.jsx)("span",{className:"course-info-item-label",children:"任课教师: "}),null===(n=I.current.teacher)||void 0===n?void 0:n.name]}),(0,l.jsxs)("div",{className:"course-info-item",children:[(0,l.jsx)("span",{className:"course-info-item-label",children:"学生人数: "}),null===(c=I.current.applyStudents)||void 0===c?void 0:c.length," 人"]}),(0,l.jsxs)("span",{className:"course-actions",children:[(0,l.jsx)("span",{className:"course-price",children:"\xa5"+j.price}),(0,l.jsx)(i.Z,{placement:"leftTop",content:(0,l.jsx)(U,{courseInfo:j,isMobile:!0}),trigger:"click",children:(0,l.jsx)("span",{className:"share-icon",children:(0,l.jsx)(u.Z,{symbol:"icon-share"})})})]})]}),(0,l.jsx)(L,{courseInfo:j,onRegisterCourse:k})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"course-title",children:j.title}),(0,l.jsxs)("div",{className:"course-info",children:[(0,l.jsxs)("div",{className:"course-info-item",children:[(0,l.jsx)("span",{className:"course-info-item-label",children:"任课教师: "}),null===(r=I.current.teacher)||void 0===r?void 0:r.name]}),(0,l.jsxs)("div",{className:"course-info-item",children:[(0,l.jsx)("span",{className:"course-info-item-label",children:"学生人数: "}),null===(h=I.current.applyStudents)||void 0===h?void 0:h.length," 人"]})]}),(0,l.jsxs)("div",{className:"course-actions",children:[(0,l.jsxs)("div",{className:"course-price",children:[" ","\xa5"+j.price]}),(0,l.jsx)(L,{courseInfo:j,onRegisterCourse:k})]}),(0,l.jsx)("div",{className:"share-area",children:(0,l.jsx)(U,{courseInfo:j})})]})})]}),(0,l.jsx)("section",{className:"course-intro",children:(0,l.jsx)(o,{items:Z})})]})};var D=n(9008),M=n.n(D),P=!0,F=B;function B(e){let s=e.data;return(0,a.useEffect)(()=>{console.log(s)},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(M(),{children:[(0,l.jsx)("title",{children:"vue培训 - "+s.title+" - 阿图教育"}),(0,l.jsx)("meta",{name:"description",content:s.summary}),(0,l.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1"}),(0,l.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,l.jsx)(A,{data:s})]})}}},function(e){e.O(0,[59,227,774,888,179],function(){return e(e.s=6877)}),_N_E=e.O()}]);